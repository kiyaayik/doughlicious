// Data produk dengan 12 menu (6 sebelumnya + 6 baru)
const products = [
  {
    id: 1,
    name: {
      id: "Croissant Almond",
      en: "Almond Croissant",
      it: "Croissant alle Mandorle",
    },
    price: 25000,
    image:
      "https://i.pinimg.com/originals/ef/f2/3e/eff23e936f25796aa4a732786473fc8b.jpg",
  },
  {
    id: 2,
    name: {
      id: "Pain au Chocolat",
      en: "Pain au Chocolat",
      it: "Pain au Chocolat",
    },
    price: 22000,
    image:
      "https://th.bing.com/th/id/OIP.Fc5B1CObarCPZqBRE6PMZQHaJQ?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3",
  },
  {
    id: 3,
    name: { id: "Danish Keju", en: "Cheese Danish", it: "Danish al Formaggio" },
    price: 28000,
    image:
      "https://tse4.mm.bing.net/th/id/OIP.DmSMZbEWWTJuBUvDJCAD0QHaHa?rs=1&pid=ImgDetMain&o=7&rm=3",
  },
  {
    id: 4,
    name: {
      id: "Éclair Coklat",
      en: "Chocolate Éclair",
      it: "Éclair al Cioccolato",
    },
    price: 32000,
    image:
      "https://thescranline.com/wp-content/uploads/2023/01/CHOCOLATE-ECLAIRS-WEB-04.jpg",
  },
  {
    id: 5,
    name: {
      id: "Macaron Campuran",
      en: "Assorted Macarons",
      it: "Macaron Assortiti",
    },
    price: 45000,
    image:
      "https://thescranline.com/wp-content/uploads/2023/01/CHOCOLATE-ECLAIRS-WEB-04.jpg",
  },
  {
    id: 6,
    name: {
      id: "Tart Stroberi",
      en: "Strawberry Tart",
      it: "Crostata di Fragole",
    },
    price: 38000,
    image:
      "https://images.unsplash.com/photo-1565958011703-44f9829ba187?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1465&q=80",
  },
  // Menu tambahan 1-6
  {
    id: 7,
    name: {
      id: "Bolu Coklat Belgia",
      en: "Belgian Chocolate Cake",
      it: "Torta al Cioccolato Belga",
    },
    price: 150000,
    image:
      "https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1389&q=80",
  },
  {
    id: 8,
    name: {
      id: "Tiramisu Klasik",
      en: "Classic Tiramisu",
      it: "Tiramisù Classico",
    },
    price: 42000,
    image:
      "https://tse1.mm.bing.net/th/id/OIP.e2gI-cGefgkJ0D_MQIcbZQHaE7?rs=1&pid=ImgDetMain&o=7&rm=3",
  },
  {
    id: 9,
    name: {
      id: "Kue Keju New York",
      en: "New York Cheesecake",
      it: "Cheesecake New York",
    },
    price: 65000,
    image:
      "https://mujermexico.com/wp-content/uploads/2023/07/cheesecake-origen.jpg",
  },
  {
    id: 10,
    name: {
      id: "Pavlova Berry",
      en: "Berry Pavlova",
      it: "Pavlova ai Frutti di Bosco",
    },
    price: 48000,
    image: "https://athomedishes.com/assets/images/1740391778375-nm2jhrf4.webp",
  },
  {
    id: 11,
    name: {
      id: "Canelé Bordeaux",
      en: "Canelé de Bordeaux",
      it: "Canelé di Bordeaux",
    },
    price: 18000,
    image: "https://i.ytimg.com/vi/tHe7rxHgflk/maxresdefault.jpg",
  },
  {
    id: 12,
    name: {
      id: "Financier Madu",
      en: "Honey Financier",
      it: "Financier al Miele",
    },
    price: 15000,
    image:
      "https://therecipemaster.com/wp-content/uploads/2025/01/financier-recipe.webp",
  },
];

// Data ulasan
const reviews = [
  {
    name: { id: "Sari Wijaya", en: "Sari Wijaya", it: "Sari Wijaya" },
    rating: 5,
    text: {
      id: "Croissant almondnya luar biasa! Renyah di luar, lembut di dalam. Toko favorit saya untuk sarapan.",
      en: "The almond croissant is amazing! Crispy on the outside, soft on the inside. My favorite bakery for breakfast.",
      it: "Il croissant alle mandorle è fantastico! Croccante fuori, morbido dentro. Il mio panificio preferito per la colazione.",
    },
    avatar: "https://randomuser.me/api/portraits/women/32.jpg",
  },
  {
    name: { id: "Budi Santoso", en: "Budi Santoso", it: "Budi Santoso" },
    rating: 4,
    text: {
      id: "Pain au chocolat terbaik di kota! Selalu segar dan coklatnya melimpah. Harga sangat worth it.",
      en: "Best pain au chocolat in town! Always fresh with generous chocolate. Very worth the price.",
      it: "Il miglior pain au chocolat in città! Sempre fresco con tanto cioccolato. Ne vale davvero il prezzo.",
    },
    avatar: "https://randomuser.me/api/portraits/men/54.jpg",
  },
  {
    name: { id: "Maria Rossi", en: "Maria Rossi", it: "Maria Rossi" },
    rating: 5,
    text: {
      id: "Saya dari Italia dan saya harus mengatakan bahwa pastri di sini sangat autentik! Danish keju mengingatkan saya pada rumah.",
      en: "I'm from Italy and I have to say the pastries here are very authentic! The cheese danish reminds me of home.",
      it: "Vengo dall'Italia e devo dire che i dolci qui sono molto autentici! Il danish al formaggio mi ricorda casa.",
    },
    avatar: "https://randomuser.me/api/portraits/women/65.jpg",
  },
];

// Data terjemahan lengkap
const translations = {
  id: {
    // Navigation
    "site-title": "Doughlicious",
    "nav-home": "Beranda",
    "nav-products": "Produk",
    "nav-reviews": "Ulasan",
    "nav-order": "Pesan",

    // Hero
    "hero-title": "Pastry Lezat, Dibuat dengan Cinta",
    "hero-text":
      "Temukan kelezatan pastry buatan tangan kami yang dipanggang segar setiap hari. Dari croissant klasik hingga kue kreatif, kami menyajikan kualitas terbaik.",
    "hero-button": "Lihat Produk Kami",

    // Products
    "products-title": "Produk Unggulan",
    "add-to-cart": "Tambah ke Keranjang",

    // Reviews
    "reviews-title": "Ulasan Pelanggan",

    // Order Form
    "order-title": "Formulir Pemesanan",
    "name-label": "Nama Lengkap",
    "email-label": "Email",
    "phone-label": "Nomor Telepon",
    "delivery-label": "Metode Pengiriman",
    "delivery-default": "Pilih metode pengiriman",
    "delivery-pickup": "Ambil di toko",
    "delivery-delivery": "Antar ke alamat",
    "address-label": "Alamat Lengkap (jika diantar)",
    "notes-label": "Catatan Tambahan (opsional)",
    "submit-order": "Pesan Sekarang",

    // Cart
    "cart-title": "Keranjang Belanja",
    "total-text": "Total:",
    "checkout-btn": "Lanjut ke Pembayaran",
    "remove-item": "Hapus",

    // Footer
    "footer-about": "Tentang Kami",
    "footer-about-text":
      "Doughlicious telah menyajikan pastry lezat sejak 2025. Kami berkomitmen menggunakan bahan terbaik dan resep tradisional.",
    "footer-contact": "Kontak",
    "footer-hours": "Jam Buka",
    "hours-mon": "Senin - Jumat: 7:00 - 20:00",
    "hours-sat": "Sabtu: 7:00 - 22:00",
    "hours-sun": "Minggu: 8:00 - 18:00",
    "footer-rights": "Semua hak dilindungi.",

    // Messages
    "order-success":
      "Pesanan berhasil! Kami akan menghubungi Anda untuk konfirmasi.",
    "cart-empty": "Keranjang Anda kosong.",
    "cart-item-added": "Ditambahkan ke keranjang!",
  },
  en: {
    // Navigation
    "site-title": "Doughlicious",
    "nav-home": "Home",
    "nav-products": "Products",
    "nav-reviews": "Reviews",
    "nav-order": "Order",

    // Hero
    "hero-title": "Delicious Pastries, Made with Love",
    "hero-text":
      "Discover the deliciousness of our handmade pastries baked fresh daily. From classic croissants to creative cakes, we serve the best quality.",
    "hero-button": "View Our Products",

    // Products
    "products-title": "Featured Products",
    "add-to-cart": "Add to Cart",

    // Reviews
    "reviews-title": "Customer Reviews",

    // Order Form
    "order-title": "Order Form",
    "name-label": "Full Name",
    "email-label": "Email",
    "phone-label": "Phone Number",
    "delivery-label": "Delivery Method",
    "delivery-default": "Select delivery method",
    "delivery-pickup": "Pickup in store",
    "delivery-delivery": "Delivery to address",
    "address-label": "Full Address (if delivered)",
    "notes-label": "Additional Notes (optional)",
    "submit-order": "Order Now",

    // Cart
    "cart-title": "Shopping Cart",
    "total-text": "Total:",
    "checkout-btn": "Proceed to Checkout",
    "remove-item": "Remove",

    // Footer
    "footer-about": "About Us",
    "footer-about-text":
      "Doughlicious has been serving delicious pastries since 2025. We are committed to using the best ingredients and traditional recipes.",
    "footer-contact": "Contact",
    "footer-hours": "Opening Hours",
    "hours-mon": "Monday - Friday: 7:00 - 20:00",
    "hours-sat": "Saturday: 7:00 - 22:00",
    "hours-sun": "Sunday: 8:00 - 18:00",
    "footer-rights": "All rights reserved.",

    // Messages
    "order-success": "Order successful! We will contact you for confirmation.",
    "cart-empty": "Your cart is empty.",
    "cart-item-added": "Added to cart!",
  },
  it: {
    // Navigation
    "site-title": "Doughlicious",
    "nav-home": "Home",
    "nav-products": "Prodotti",
    "nav-reviews": "Recensioni",
    "nav-order": "Ordina",

    // Hero
    "hero-title": "Pasticceria Deliziosa, Fatta con Amore",
    "hero-text":
      "Scopri la delizia delle nostre pasticcerie fatte a mano, cotte fresche ogni giorno. Dai croissant classici alle torte creative, serviamo la migliore qualità.",
    "hero-button": "Vedi i Nostri Prodotti",

    // Products
    "products-title": "Prodotti in Evidenza",
    "add-to-cart": "Aggiungi al Carrello",

    // Reviews
    "reviews-title": "Recensioni dei Clienti",

    // Order Form
    "order-title": "Modulo d'Ordine",
    "name-label": "Nome Completo",
    "email-label": "Email",
    "phone-label": "Numero di Telefono",
    "delivery-label": "Metodo di Consegna",
    "delivery-default": "Seleziona metodo di consegna",
    "delivery-pickup": "Ritiro in negozio",
    "delivery-delivery": "Consegna a domicilio",
    "address-label": "Indirizzo Completo (se consegnato)",
    "notes-label": "Note Aggiuntive (opzionale)",
    "submit-order": "Ordina Ora",

    // Cart
    "cart-title": "Carrello della Spesa",
    "total-text": "Totale:",
    "checkout-btn": "Procedi al Pagamento",
    "remove-item": "Rimuovi",

    // Footer
    "footer-about": "Chi Siamo",
    "footer-about-text":
      "Doughlicious serve deliziose pasticcerie dal 2025. Ci impegniamo a utilizzare i migliori ingredienti e ricette tradizionali.",
    "footer-contact": "Contatti",
    "footer-hours": "Orari di Apertura",
    "hours-mon": "Lunedì - Venerdì: 7:00 - 20:00",
    "hours-sat": "Sabato: 7:00 - 22:00",
    "hours-sun": "Domenica: 8:00 - 18:00",
    "footer-rights": "Tutti i diritti riservati.",

    // Messages
    "order-success":
      "Ordine effettuato con successo! Ti contatteremo per la conferma.",
    "cart-empty": "Il tuo carrello è vuoto.",
    "cart-item-added": "Aggiunto al carrello!",
  },
};

// State aplikasi
let currentLanguage = "id";
let cart = [];
let cartTotal = 0;

// Format harga ke Rupiah
function formatPrice(price) {
  if (currentLanguage === "en") {
    return `$${(price / 14000).toFixed(2)}`;
  } else if (currentLanguage === "it") {
    return `€${(price / 16000).toFixed(2)}`;
  } else {
    return `Rp ${price.toLocaleString("id-ID")}`;
  }
}

// Render produk
function renderProducts() {
  const productsContainer = document.getElementById("products-container");
  if (!productsContainer) return;

  productsContainer.innerHTML = "";

  products.forEach((product) => {
    const productCard = document.createElement("div");
    productCard.className = "product-card";
    productCard.innerHTML = `
            <div class="product-img">
                <img src="${product.image}" alt="${product.name[currentLanguage]}">
            </div>
            <div class="product-info">
                <h3 class="product-name">${product.name[currentLanguage]}</h3>
                <p class="product-price">${formatPrice(product.price)}</p>
                <button class="add-to-cart" data-id="${product.id}">
                    ${translations[currentLanguage]["add-to-cart"]}
                </button>
            </div>
        `;
    productsContainer.appendChild(productCard);
  });

  // Tambahkan event listener untuk tombol "Tambah ke Keranjang"
  document.querySelectorAll(".add-to-cart").forEach((button) => {
    button.addEventListener("click", function () {
      const productId = parseInt(this.getAttribute("data-id"));
      addToCart(productId);
    });
  });
}

// Render ulasan
function renderReviews() {
  const reviewsContainer = document.getElementById("reviews-container");
  if (!reviewsContainer) return;

  reviewsContainer.innerHTML = "";

  reviews.forEach((review) => {
    const reviewCard = document.createElement("div");
    reviewCard.className = "review-card";

    // Buang rating bintang
    let stars = "";
    for (let i = 0; i < 5; i++) {
      if (i < review.rating) {
        stars += '<i class="fas fa-star"></i>';
      } else {
        stars += '<i class="far fa-star"></i>';
      }
    }

    reviewCard.innerHTML = `
            <div class="review-header">
                <div class="review-avatar">
                    <img src="${review.avatar}" alt="${review.name[currentLanguage]}">
                </div>
                <div>
                    <h4 class="review-name">${review.name[currentLanguage]}</h4>
                    <div class="review-rating">${stars}</div>
                </div>
            </div>
            <p class="review-text">"${review.text[currentLanguage]}"</p>
        `;
    reviewsContainer.appendChild(reviewCard);
  });
}

// Update terjemahan
function updateTranslations() {
  Object.keys(translations[currentLanguage]).forEach((key) => {
    const element = document.getElementById(key);
    if (element) {
      if (
        key === "submit-order" ||
        key === "checkout-btn" ||
        key === "add-to-cart" ||
        key === "hero-button" ||
        key === "remove-item"
      ) {
        element.textContent = translations[currentLanguage][key];
      } else if (key === "footer-about-text" || key === "hero-text") {
        element.textContent = translations[currentLanguage][key];
      } else {
        element.textContent = translations[currentLanguage][key];
      }
    }
  });

  // Update placeholder untuk textarea catatan
  const notesTextarea = document.getElementById("notes");
  if (notesTextarea) {
    if (currentLanguage === "id") {
      notesTextarea.placeholder = "Contoh: Tanpa kacang, tambah coklat, dll.";
    } else if (currentLanguage === "en") {
      notesTextarea.placeholder = "Example: No nuts, extra chocolate, etc.";
    } else if (currentLanguage === "it") {
      notesTextarea.placeholder = "Esempio: Senza noci, cioccolato extra, ecc.";
    }
  }
}

// Update cart count
function updateCartCount() {
  const cartCount = document.getElementById("cart-count");
  if (!cartCount) return;

  const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
  cartCount.textContent = totalItems;
}

// Update cart total
function updateCartTotal() {
  const cartTotalElement = document.getElementById("cart-total-price");
  if (!cartTotalElement) return;

  cartTotal = cart.reduce((sum, item) => {
    const product = products.find((p) => p.id === item.id);
    return sum + product.price * item.quantity;
  }, 0);

  cartTotalElement.textContent = formatPrice(cartTotal);
}

// Render cart items
function renderCartItems() {
  const cartItemsContainer = document.getElementById("cart-items");
  if (!cartItemsContainer) return;

  if (cart.length === 0) {
    cartItemsContainer.innerHTML = `<p>${translations[currentLanguage]["cart-empty"]}</p>`;
    updateCartTotal();
    return;
  }

  cartItemsContainer.innerHTML = "";

  cart.forEach((item) => {
    const product = products.find((p) => p.id === item.id);
    if (!product) return;

    const cartItem = document.createElement("div");
    cartItem.className = "cart-item";
    cartItem.innerHTML = `
            <div class="cart-item-info">
                <h4>${product.name[currentLanguage]}</h4>
                <p class="cart-item-price">${formatPrice(product.price)}</p>
            </div>
            <div class="cart-item-quantity">
                <button class="quantity-btn decrease" data-id="${product.id}">-</button>
                <span class="cart-quantity">${item.quantity}</span>
                <button class="quantity-btn increase" data-id="${product.id}">+</button>
                <button class="remove-item" data-id="${product.id}">${translations[currentLanguage]["remove-item"]}</button>
            </div>
        `;
    cartItemsContainer.appendChild(cartItem);
  });

  // Tambahkan event listeners untuk tombol di cart
  document.querySelectorAll(".quantity-btn.decrease").forEach((button) => {
    button.addEventListener("click", function () {
      const productId = parseInt(this.getAttribute("data-id"));
      updateCartItemQuantity(productId, -1);
    });
  });

  document.querySelectorAll(".quantity-btn.increase").forEach((button) => {
    button.addEventListener("click", function () {
      const productId = parseInt(this.getAttribute("data-id"));
      updateCartItemQuantity(productId, 1);
    });
  });

  document.querySelectorAll(".remove-item").forEach((button) => {
    button.addEventListener("click", function () {
      const productId = parseInt(this.getAttribute("data-id"));
      removeFromCart(productId);
    });
  });

  updateCartTotal();
}

// Tambah item ke cart
function addToCart(productId) {
  const existingItem = cart.find((item) => item.id === productId);

  if (existingItem) {
    existingItem.quantity += 1;
  } else {
    cart.push({ id: productId, quantity: 1 });
  }

  updateCartCount();
  renderCartItems();

  // Tampilkan notifikasi
  alert(translations[currentLanguage]["cart-item-added"]);
}

// Update quantity item di cart
function updateCartItemQuantity(productId, change) {
  const item = cart.find((item) => item.id === productId);

  if (item) {
    item.quantity += change;

    if (item.quantity <= 0) {
      cart = cart.filter((item) => item.id !== productId);
    }
  }

  updateCartCount();
  renderCartItems();
}

// Hapus item dari cart
function removeFromCart(productId) {
  cart = cart.filter((item) => item.id !== productId);
  updateCartCount();
  renderCartItems();
}

// Toggle cart modal
function toggleCartModal() {
  const cartModal = document.getElementById("cart-modal");
  const overlay = document.getElementById("overlay");

  cartModal.classList.toggle("open");
  overlay.classList.toggle("active");

  // Render ulang item cart saat modal dibuka
  if (cartModal.classList.contains("open")) {
    renderCartItems();
  }
}

// Inisialisasi aplikasi
function initApp() {
  // Set tahun saat ini di footer
  const currentYearElement = document.getElementById("current-year");
  if (currentYearElement) {
    currentYearElement.textContent = new Date().getFullYear();
  }

  // Render konten awal
  renderProducts();
  renderReviews();
  updateTranslations();
  updateCartCount();

  // Event listener untuk tombol bahasa
  document.querySelectorAll(".lang-btn").forEach((button) => {
    button.addEventListener("click", function () {
      const lang = this.getAttribute("data-lang");

      // Update tombol aktif
      document.querySelectorAll(".lang-btn").forEach((btn) => {
        btn.classList.remove("active");
      });
      this.classList.add("active");

      // Update bahasa
      currentLanguage = lang;
      renderProducts();
      renderReviews();
      updateTranslations();
      renderCartItems();
    });
  });

  // Event listener untuk ikon cart
  const cartIcon = document.getElementById("cart-icon");
  if (cartIcon) {
    cartIcon.addEventListener("click", toggleCartModal);
  }

  // Event listener untuk tombol close cart
  const closeCartBtn = document.getElementById("close-cart");
  if (closeCartBtn) {
    closeCartBtn.addEventListener("click", toggleCartModal);
  }

  // Event listener untuk overlay
  const overlay = document.getElementById("overlay");
  if (overlay) {
    overlay.addEventListener("click", toggleCartModal);
  }

  // Event listener untuk tombol checkout
  const checkoutBtn = document.getElementById("checkout-btn");
  if (checkoutBtn) {
    checkoutBtn.addEventListener("click", function (e) {
      e.preventDefault();
      if (cart.length === 0) {
        alert(translations[currentLanguage]["cart-empty"]);
        return;
      }
      alert(
        `${translations[currentLanguage]["checkout-btn"]} - ${formatPrice(cartTotal)}`,
      );
    });
  }

  // Event listener untuk formulir pemesanan
  const orderForm = document.getElementById("order-form");
  if (orderForm) {
    orderForm.addEventListener("submit", function (e) {
      e.preventDefault();

      // Validasi sederhana
      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const phone = document.getElementById("phone").value;
      const delivery = document.getElementById("delivery").value;

      if (!name || !email || !phone || !delivery) {
        alert("Harap isi semua field yang wajib diisi.");
        return;
      }

      // Tampilkan konfirmasi
      alert(translations[currentLanguage]["order-success"]);

      // Reset formulir
      orderForm.reset();

      // Reset keranjang
      cart = [];
      updateCartCount();
      renderCartItems();
    });
  }

  // Smooth scroll untuk navigation links
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();

      const targetId = this.getAttribute("href");
      if (targetId === "#") return;

      const targetElement = document.querySelector(targetId);
      if (targetElement) {
        window.scrollTo({
          top: targetElement.offsetTop - 80,
          behavior: "smooth",
        });
      }
    });
  });
}

// Jalankan aplikasi saat DOM siap
document.addEventListener("DOMContentLoaded", initApp);
